{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"Adding Cassandra Node in OpenShift to Existing Cluster","alternative_id":5342,"content":"<p>I have 3 cassandra nodes(S1,S2,S3) which are installed on CentOS 6. Two of them (S1,S2) are in datacenter A and one of them (S3) is in openshift. I am trying to make benchmark test with multiple node clusters in multiple data centers.</p>\n<p>Cassandra installations and configurations on nodes S1 and S2 are based on <a href=\"http://www.datastax.com/documentation/cassandra/2.0/cassandra/install/installRHEL_t.html\" rel=\"nofollow noreferrer\">Installing DataStax Community on RHEL-based systems</a> on the other hand cassandra installation on node S3 (openshift) is based on <a href=\"https://www.openshift.com/blogs/cassandra-on-openshift\" rel=\"nofollow noreferrer\">How To Configure and Run Cassandra on OpenShift</a>.</p>\n<p>All servers running fine but i could not add node S3 to cluster. All servers has exactly same configuration files (cassandra.yaml and cassandra-topology.properties)</p>\n<p>Nodes S1 and S2 have 1.2.18 version of cassandra.</p>\n<pre>[root@node1 ~]# cassandra -v\n1.2.18\n</pre>\n<p>Node S3 has 1.1.6 version of cassandra.</p>\n<pre>[cassandra-xxxx.rhcloud.com xxxxxxxx]\\&gt; app-root/data/cassandra/bin/cassandra -v\nxss =  -ea -javaagent:app-root/data/cassandra/bin/../lib/jamm-0.2.5.jar -XX:+UseThreadPriorities -XX:ThreadPriorityPolicy=42 -Xms1834M -Xmx1834M -Xmn256M -XX:+HeapDumpOnOutOfMemoryError -Xss180k\n1.1.6 \n</pre>\n<p>All nodes have same cassandra.yaml and cassandra-topology.properties configurations as shown below(except listening ip address).</p>\n<p><strong>cassandra.yaml</strong></p>\n<pre>cluster_name: 'MyDemoCluster'\nnum_tokens: 256\nseed_provider:\n  - class_name: org.apache.cassandra.locator.SimpleSeedProvider\n    parameters:\n         - seeds:  \"x.x.x.236\"\nlisten_address: x.x.x.x\nendpoint_snitch: PropertyFileSnitch\n</pre>\n<p><strong>cassandra-topology.properties</strong></p>\n<pre># Cassandra Node IP=Data Center:Rack\nx.x.x.236=XXX:RAC1\nx.x.x.237=XXX:RAC2\ny.y.y.yyy=OPS:RAC1\n</pre>\n<p>First of all , i started seed node while other nodes stopping. After a successfully start action i started other nodes(without any error messages in log files). </p>\n<p>Then when i run nodetool on seed node , i only see nodes S1 and S2 but not node S3.</p>\n<pre>[root@node1]# nodetool status\nDatacenter: XXX\n===============\nStatus=Up/Down\n|/ State=Normal/Leaving/Joining/Moving\n--  Address          Load       Tokens  Owns (effective)  Host ID                               Rack\nUN  x.x.x.236  79.25 KB   256     100.0%            xxxxxxxx-xxxx-404a-aa3f-fbddfb5da124  RAC2\nUN  x.x.x.237  79.56 KB   256     100.0%            xxxxxxxx-xxxx-4b27-970b-76944c382c9f  RAC1\n</pre>\n<p><strong>cassandra log of Node S2</strong></p>\n<pre> INFO [HANDSHAKE-/x.x.x.236] 2014-08-08 11:25:26,120 OutboundTcpConnection.java (line 418) Handshaking version with /x.x.x.\n</pre>\n<p><strong>Running cassandra on node S3</strong></p>\n<pre>    [cassandra-biberltd.rhcloud.com data]\\&gt; cassandra/bin/cassandra -f\nxss =  -ea -javaagent:cassandra/bin/../lib/jamm-0.2.5.jar -XX:+UseThreadPriorities -XX:ThreadPriorityPolicy=42 -Xms1834M -Xmx1834M -Xmn256M -XX:+HeapDumpOnOutOfMemoryError -Xss180k\n INFO 11:36:31,296 Logging initialized\n INFO 11:36:31,305 JVM vendor/version: OpenJDK Server VM/1.7.0_65\n INFO 11:36:31,305 Heap size: 1896284160/1896284160\n INFO 11:36:31,305 Classpath: cassandra/bin/../conf:cassandra/bin/../build/classes/main:cassandra/bin/../build/classes/thrift:cassandra/bin/../lib/antlr-3.2.jar:cassandra/bin/../lib/apache-cassandra-1.1.6.jar:cassandra/bin/../lib/apache-cassandra-clientutil-1.1.6.jar:cassandra/bin/../lib/apache-cassandra-thrift-1.1.6.jar:cassandra/bin/../lib/avro-1.4.0-fixes.jar:cassandra/bin/../lib/avro-1.4.0-sources-fixes.jar:cassandra/bin/../lib/commons-cli-1.1.jar:cassandra/bin/../lib/commons-codec-1.2.jar:cassandra/bin/../lib/commons-lang-2.4.jar:cassandra/bin/../lib/compress-lzf-0.8.4.jar:cassandra/bin/../lib/concurrentlinkedhashmap-lru-1.3.jar:cassandra/bin/../lib/guava-r08.jar:cassandra/bin/../lib/high-scale-lib-1.1.2.jar:cassandra/bin/../lib/jackson-core-asl-1.9.2.jar:cassandra/bin/../lib/jackson-mapper-asl-1.9.2.jar:cassandra/bin/../lib/jamm-0.2.5.jar:cassandra/bin/../lib/jline-0.9.94.jar:cassandra/bin/../lib/json-simple-1.1.jar:cassandra/bin/../lib/libthrift-0.7.0.jar:cassandra/bin/../lib/log4j-1.2.16.jar:cassandra/bin/../lib/metrics-core-2.0.3.jar:cassandra/bin/../lib/servlet-api-2.5-20081211.jar:cassandra/bin/../lib/slf4j-api-1.6.1.jar:cassandra/bin/../lib/slf4j-log4j12-1.6.1.jar:cassandra/bin/../lib/snakeyaml-1.6.jar:cassandra/bin/../lib/snappy-java-1.0.4.1.jar:cassandra/bin/../lib/snaptree-0.1.jar:cassandra/bin/../lib/jamm-0.2.5.jar\n INFO 11:36:31,308 JNA not found. Native methods will be disabled.\n INFO 11:36:31,329 Loading settings from file:/var/lib/openshift/53e4cf805004462c540000a9/app-root/data/cassandra/conf/cassandra.yaml\n INFO 11:36:31,649 32bit JVM detected.  It is recommended to run Cassandra on a 64bit JVM for better performance.\n INFO 11:36:31,650 DiskAccessMode 'auto' determined to be standard, indexAccessMode is standard\n INFO 11:36:32,322 Global memtable threshold is enabled at 602MB\n INFO 11:36:33,196 Initializing key cache with capacity of 90 MBs.\n INFO 11:36:33,218 Scheduling key cache save to each 14400 seconds (going to save all keys).\n INFO 11:36:33,220 Initializing row cache with capacity of 0 MBs and provider org.apache.cassandra.cache.SerializingCacheProvider\n INFO 11:36:33,228 Scheduling row cache save to each 0 seconds (going to save all keys).\n INFO 11:36:33,595 Couldn't detect any schema definitions in local storage.\n INFO 11:36:33,596 Found table data in data directories. Consider using the CLI to define your schema.\n INFO 11:36:33,664 No commitlog files found; skipping replay\n INFO 11:36:33,730 Cassandra version: 1.1.6\n INFO 11:36:33,730 Thrift API version: 19.32.0\n INFO 11:36:33,735 CQL supported versions: 2.0.0,3.0.0-beta1 (default: 2.0.0)\n INFO 11:36:33,835 Loading persisted ring state\n INFO 11:36:33,839 Starting up server gossip\n INFO 11:36:33,862 Enqueuing flush of Memtable-LocationInfo@8039520(135/168 serialized/live bytes, 3 ops)\n INFO 11:36:33,863 Writing Memtable-LocationInfo@8039520(135/168 serialized/live bytes, 3 ops)\n INFO 11:36:33,945 Completed flushing $HOME/app-root/data/cassandra-data/data/system/LocationInfo/system-LocationInfo-hf-1-Data.db (243 bytes) for commitlog position ReplayPosition(segmentId=1407512193559, position=595)\n INFO 11:36:33,982 Starting Messaging Service on port 17000\n INFO 11:36:33,995 JOINING: waiting for ring information\n INFO 11:37:04,035 JOINING: schema complete, ready to bootstrap\n INFO 11:37:04,036 JOINING: getting bootstrap token\n INFO 11:37:04,045 Enqueuing flush of Memtable-LocationInfo@21839213(53/66 serialized/live bytes, 2 ops)\n INFO 11:37:04,046 Writing Memtable-LocationInfo@21839213(53/66 serialized/live bytes, 2 ops)\n INFO 11:37:04,079 Completed flushing $HOME/app-root/data/cassandra-data/data/system/LocationInfo/system-LocationInfo-hf-2-Data.db (163 bytes) for commitlog position ReplayPosition(segmentId=1407512193559, position=776)\n INFO 11:37:04,082 JOINING: sleeping 30000 ms for pending range setup\n INFO 11:37:34,083 JOINING: Starting to bootstrap...\n INFO 11:37:34,103 Enqueuing flush of Memtable-LocationInfo@21895329(53/66 serialized/live bytes, 2 ops)\n INFO 11:37:34,103 Writing Memtable-LocationInfo@21895329(53/66 serialized/live bytes, 2 ops)\n INFO 11:37:34,140 Completed flushing $HOME/app-root/data/cassandra-data/data/system/LocationInfo/system-LocationInfo-hf-3-Data.db (163 bytes) for commitlog position ReplayPosition(segmentId=1407512193559, position=957)\n INFO 11:37:34,154 Node /y.y.y.yyy state jump to normal\n INFO 11:37:34,155 Bootstrap/Replace/Move completed! Now serving reads.\n INFO 11:37:34,221 Binding thrift service to /y.y.y.yyy:19160\n INFO 11:37:34,226 Using TFastFramedTransport with a max frame size of 15728640 bytes.\n INFO 11:37:34,232 Using synchronous/threadpool thrift server on /y.y.y.yyy : 19160\n INFO 11:37:34,233 Listening for thrift clients...\n</pre>\n<p>I only found </p>\n<pre> INFO 11:36:31,308 JNA not found. Native methods will be disabled.\n</pre>\n<p>My questions are </p>\n<ol><li>How can i add openshift node to cluster?</li>\n<li>Does openshift support nodes which is a member of multiple data centers cluster?</li>\n<li>Must all nodes have same version of cassandra?</li>\n</ol>"}}]}},"pageContext":{"alternative_id":5342}}