{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"LukeTillman/dse-docker","alternative_id":228,"content":"<h3>\n      \n      README.md\n    </h3><article class=\"markdown-body entry-content\" itemprop=\"text\">\n<p>DataStax has started offering <a href=\"https://github.com/datastax/docker-images\">official Docker images</a> for development environments, which is great news! I\nwas fortunate to be involved in the planning and creation of those images, so if you were using this image before, transitioning\nto the new official images should involve minimal or no changes. This repository is now archived and not actively maintained. I\nencourage you to check out the new <a href=\"https://github.com/datastax/docker-images\">official Docker images</a> and open issues/PRs there to help us improve them.</p>\n<p>Thanks to everyone who helped make this image better by opening issues and PRs. And thanks to everyone who used this image which\nultimately played a small role in encouraging DataStax to release official images of their own.</p>\n<hr />\n<p><a href=\"https://travis-ci.org/LukeTillman/dse-docker\" rel=\"nofollow\"><img src=\"https://camo.githubusercontent.com/3100e829e9af5bc585d3bec5e842128029128b69/68747470733a2f2f7472617669732d63692e6f72672f4c756b6554696c6c6d616e2f6473652d646f636b65722e7376673f6272616e63683d6d6173746572\" alt=\"Build Status\" data-canonical-src=\"https://travis-ci.org/LukeTillman/dse-docker.svg?branch=master\" /></a></p>\n<p>A Docker image for <a href=\"http://www.datastax.com/products/datastax-enterprise\" rel=\"nofollow\">DataStax Enterprise</a>. Please use the\n<a href=\"https://github.com/LukeTillman/dse-docker\">GitHub repository</a> for opening issues.</p>\n<h2><a class=\"anchor\" aria-hidden=\"true\" href=\"#usage\"></a>Usage</h2>\n<blockquote>\n<p><strong>Note:</strong> Not meant for production use. See <a href=\"http://www.datastax.com/wp-content/uploads/resources/DataStax-WP-Best_Practices_Running_DSE_Within_Docker.pdf\" rel=\"nofollow\">this whitepaper on DataStax.com</a> for\ndetails on setting up DSE and Docker in production.</p>\n</blockquote>\n<h3><a id=\"user-content-starting-dse\" class=\"anchor\" aria-hidden=\"true\" href=\"#starting-dse\"></a>Starting DSE</h3>\n<p>By default, this image will start DSE <em>in Cassandra only</em> mode. For example:</p>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker run --name my-dse -d luketillman/datastax-enterprise:TAG</pre></div>\n<p>You should replace <code>TAG</code> in all of these examples with the version of DSE you are trying to\nstart. (See the <a href=\"https://hub.docker.com/r/luketillman/datastax-enterprise/tags/\" rel=\"nofollow\">Docker Hub tags</a> for a list of available versions.)</p>\n<p>The image's entrypoint script runs the command <code>dse cassandra</code> and will append any switches you\nprovide to that command. So it's possible to start DSE in any of the other supported modes by\nadding switches to the end of your <code>docker run</code> command.</p>\n<h4><a id=\"user-content-example-start-a-graph-node\" class=\"anchor\" aria-hidden=\"true\" href=\"#example-start-a-graph-node\"></a>Example: Start a Graph Node</h4>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker run --name my-dse -d luketillman/datastax-enterprise:TAG -g</pre></div>\n<p>In the container, this will run <code>dse cassandra -g</code> to start a graph node.</p>\n<h4><a id=\"user-content-example-start-an-analytics-spark-node\" class=\"anchor\" aria-hidden=\"true\" href=\"#example-start-an-analytics-spark-node\"></a>Example: Start an Analytics (Spark) Node</h4>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker run --name my-dse -d luketillman/datastax-enterprise:TAG -k</pre></div>\n<p>In the container, this will run <code>dse cassandra -k</code> to start an analytics node.</p>\n<h4><a id=\"user-content-example-start-a-search-node\" class=\"anchor\" aria-hidden=\"true\" href=\"#example-start-a-search-node\"></a>Example: Start a Search Node</h4>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker run --name my-dse -d luketillman/datastax-enterprise:TAG -s</pre></div>\n<p>In the container, this will run <code>dse cassandra -s</code> to start a search node.</p>\n<p>You can also use combinations of those switches. For more examples, see the <a href=\"http://docs.datastax.com/en/dse/5.1/dse-admin/datastax_enterprise/operations/startStop/startDseStandalone.html\" rel=\"nofollow\">Starting DSE</a>\ndocumentation.</p>\n<h3><a id=\"user-content-exposing-ports-on-the-host\" class=\"anchor\" aria-hidden=\"true\" href=\"#exposing-ports-on-the-host\"></a>Exposing Ports on the Host</h3>\n<p>Chances are you'll want to expose some ports on the host so that you can talk to DSE from\noutside of Docker (for example, from code running on your local machine). You can do that using\nthe <code>-p</code> switch when calling <code>docker run</code> and the most common port you'll probably want to\nexpose is <strong>9042</strong> which is where CQL clients communicate. For example:</p>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker run --name my-dse -d -p 9042:9042 luketillman/datastax-enterprise:TAG</pre></div>\n<p>This will expose the container's CQL client port (9042) on the host at port 9042. For a list of\nthe ports used by DSE, see the <a href=\"http://docs.datastax.com/en/dse/5.1/dse-admin/datastax_enterprise/security/secFirewallPorts.html\" rel=\"nofollow\">Securing DataStax Enterprise ports</a> documentation.</p>\n<h3><a id=\"user-content-starting-related-tools\" class=\"anchor\" aria-hidden=\"true\" href=\"#starting-related-tools\"></a>Starting Related Tools</h3>\n<p>With a node running, use <code>docker exec</code> to run other tools. For example, the <code>nodetool status</code>\ncommand:</p>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker exec -it my-dse nodetool status</pre></div>\n<p>Or to connect with <code>cqlsh</code>:</p>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker exec -it my-dse cqlsh</pre></div>\n<h3><a id=\"user-content-environment-variables\" class=\"anchor\" aria-hidden=\"true\" href=\"#environment-variables\"></a>Environment Variables</h3>\n<p>The following environment variables can be set at runtime to override configuration. Setting the\nfollowing values will override the corresponding settings in the <code>cassandra.yaml</code> configuration\nfile:</p>\n<ul><li><strong><code>LISTEN_ADDRESS</code></strong>: The IP address to listen for connections from other nodes. Defaults to\nthe hostname's IP address.</li>\n<li><strong><code>BROADCAST_ADDRESS</code></strong>: The IP address to advertise to other nodes. Defaults to the same\nvalue as the <code>LISTEN_ADDRESS</code>.</li>\n<li><strong><code>RPC_ADDRESS</code></strong>: The IP address to listen for client/driver connections. Defaults to\n<code>0.0.0.0</code> (i.e. wildcard).</li>\n<li><strong><code>BROADCAST_RPC_ADDRESS</code></strong>: The IP address to advertise to clients/drivers. Defaults to the\nsame value as the <code>BROADCAST_ADDRESS</code>.</li>\n<li><strong><code>SEEDS</code></strong>: The comma-delimited list of seed nodes for the cluster. Defaults to this node's\n<code>BROADCAST_ADDRESS</code> if not set and will only be set the first time the node is started.</li>\n<li><strong><code>START_RPC</code></strong>: Whether to start the Thrift RPC server. Will leave the default in the\n<code>cassandra.yaml</code> file if not set.</li>\n<li><strong><code>CLUSTER_NAME</code></strong>: The name of the cluster. Will leave the default in the <code>cassandra.yaml</code>\nfile if not set.</li>\n<li><strong><code>NUM_TOKENS:</code></strong>: The number of tokens randomly assigned to this node. Will leave the\ndefault in the <code>cassandra.yaml</code> file if not set.</li>\n</ul><p>If you need more advanced control over the configuration, the configuration files are exposed\nas a volume (under <code>/opt/dse/resources</code>) which would allow you to mount a more customized\nconfiguration file from the host. See below for more information on volumes.</p>\n<h3><a id=\"user-content-volumes\" class=\"anchor\" aria-hidden=\"true\" href=\"#volumes\"></a>Volumes</h3>\n<p>The following volumes are created and can be mounted to the host system:</p>\n<ul><li><strong><code>/var/lib/cassandra</code></strong>: Data from Cassandra</li>\n<li><strong><code>/var/lib/spark</code></strong>: Data from DSE Analytics w/ Spark</li>\n<li><strong><code>/var/lib/dsefs</code></strong>: Data from DSEFS</li>\n<li><strong><code>/var/log/cassandra</code></strong>: Logs from Cassandra</li>\n<li><strong><code>/var/log/spark</code></strong>: Logs from Spark</li>\n<li><strong><code>/opt/dse/resources</code></strong>: Most configuration files including <code>cassandra.yaml</code>, <code>dse.yaml</code>, and\nmore can be found here.</li>\n</ul><h3><a id=\"user-content-logging\" class=\"anchor\" aria-hidden=\"true\" href=\"#logging\"></a>Logging</h3>\n<p>You can view logs via Docker's container logs:</p>\n<div class=\"highlight highlight-text-shell-session\"><pre>docker logs my-dse</pre></div>\n<h2><a id=\"user-content-builds\" class=\"anchor\" aria-hidden=\"true\" href=\"#builds\"></a>Builds</h2>\n<p>Build and publish scripts are available in the <code>build</code> folder of the repository. All those\nscripts are meant to be run from the root of the repository. For example:</p>\n<div class=\"highlight highlight-text-shell-session\"><pre>&gt; ./build/docker-build.sh</pre></div>\n<p>Because DSE requires credentials to download, the build requires some way to access those\ncredentials without baking them into the final image and exposing them. Since Docker doesn't\ncurrent support build-time secrets, I had to come up with a \"creative\" (read: hacky) workaround\nto grab those credentials via a local HTTP server during the build and then remove them after\nwe've downloaded DSE. You can see <a href=\"https://github.com/LukeTillman/dse-docker/issues/8\">Issue 8</a> and the files in the <code>srv</code> directory for\nmore details.</p>\n<p>Continuous integration builds are handled by Travis.</p>\n</article>"}}]}},"pageContext":{"alternative_id":228}}