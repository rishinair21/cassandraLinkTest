{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"instaclustr/cassandra-operator","alternative_id":11799,"content":"<h2>Cassandra operator</h2><p>Build <a href=\"https://circleci.com/gh/instaclustr/cassandra-operator/tree/master\" rel=\"nofollow\"><img src=\"https://camo.githubusercontent.com/e8818f6860bae206f9f5897efb222eb3b3d4e310/68747470733a2f2f636972636c6563692e636f6d2f67682f696e737461636c757374722f63617373616e6472612d6f70657261746f722f747265652f6d61737465722e7376673f7374796c653d737667\" alt=\"CircleCI\" data-canonical-src=\"https://circleci.com/gh/instaclustr/cassandra-operator/tree/master.svg?style=svg\" /></a></p><h3>Project status: pre-alpha</h3><p>Major planned features have yet to be completed and API changes are currently planned, we reserve the right to address bugs and API changes in a backwards incompatible way before the project is declared stable. See <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/user/upgrade/upgrade_guide.md\">upgrade guide</a> for safe upgrade process.</p><p>Currently user facing Cassandra cluster objects are created as <a href=\"https://kubernetes.io/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/\" rel=\"nofollow\">Kubernetes Custom Resources</a>, however, taking advantage of <a href=\"https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/aggregated-api-servers.md\">User Aggregated API Servers</a> to improve reliability, validation and versioning may be undertaken. The use of Aggregated API should be minimally disruptive to existing users but may change what Kubernetes objects are created or how users deploy the  operator.</p><p>We expect to consider the Cassandra operator stable soon; backwards incompatible changes will not be made once the project reaches stability.</p><h2>Overview</h2><p>The Cassandra operator manages Cassandra clusters deployed to <a href=\"http://kubernetes.io\" rel=\"nofollow\">Kubernetes</a> and automates tasks related to operating an Cassandra cluster.</p><ul><li><a href=\"#deploy-cassandra-operator\">Install</a></li>\n<li><a href=\"#create-and-destroy-an-Cassandra-cluster\">Create and destroy</a></li>\n<li><a href=\"#resize-an-Cassandra-cluster\">Resize</a></li>\n<li><a href=\"#node-recovery\">Recover a node</a> - <em>TODO</em></li>\n<li><a href=\"#disaster-recovery\">Backup and restore a cluster</a> - <em>TODO</em></li>\n<li><a href=\"#upgrade-an-Cassandra-cluster\">Rolling upgrade</a> - <em>TODO</em></li>\n<li><a href=\"#limitations\">Limitations</a></li>\n</ul><p>There are <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/spec_examples.md\">more spec examples</a> on setting up clusters with backup, restore, and other configurations.</p><p>Read <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/best_practices.md\">Best Practices</a> for more information on how to better use Cassandra operator.</p><p>Read <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/rbac.md\">RBAC docs</a> for how to setup RBAC rules for Cassandra operator if RBAC is in place.</p><p>Read <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/developers.md\">Developer Guide</a> for setting up development environment if you want to contribute.</p><p>See the <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/resources.md\">Resources and Labels</a> doc for an overview of the resources created by the Cassandra-operator.</p><h2>Requirements</h2><ul><li>Kubernetes 1.8+</li>\n<li>Cassandra 3.11+</li>\n</ul><h2>Deploy Cassandra operator</h2><p>See <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/op_guide.md\">instructions on how to install/uninstall Cassandra operator</a> .</p><h2>Create and destroy an Cassandra cluster</h2><div class=\"highlight highlight-source-shell\"><pre>$ kubectl create -f example/common/test.yaml</pre></div><p>A 3 member Cassandra cluster will be created.</p><div class=\"highlight highlight-source-shell\"><pre>$ kubectl get pods\nNAME                                    READY     STATUS    RESTARTS   AGE\ncassandra-operator7-5d58bc7874-t85dt    1/1       Running   0          18h\ntest-dc-0                               1/1       Running   0          1m\ntest-dc-1                               1/1       Running   0          1m\ntest-dc-2                               1/1       Running   0          1m</pre></div><p>See <a href=\"https://github.com/instaclustr/cassandra-operator/blob/master/doc/user/client_service.md\">client service</a> for how to access Cassandra clusters created by operator.</p><p>Destroy Cassandra cluster:</p><div class=\"highlight highlight-source-shell\"><pre>$ kubectl delete -f example/common/test.yaml</pre></div><h2>Resize an Cassandra cluster</h2><p>Create an Cassandra cluster, if you haven't already:</p><div class=\"highlight highlight-source-shell\"><pre>$ kubectl apply -f example/common/test.yaml</pre></div><p>In <code>example/common/test.yaml</code> the initial cluster size is 3.\nModify the file and change <code>replicas</code> from 3 to 5.</p><div class=\"highlight highlight-source-yaml\"><pre>apiVersion: stable.instaclustr.com/v1\nkind: CassandraDataCenter\nmetadata:\n  name: test-dc\nspec:\n  replicas: 5\n  image: \"gcr.io/cassandra-operator/cassandra:latest\"</pre></div><p>Apply the size change to the cluster CR:</p><div class=\"highlight highlight-source-shell\"><pre>$ kubectl apply -f example/common/test.yaml</pre></div><p>The Cassandra cluster will scale to 5 members (5 pods):</p><div class=\"highlight highlight-source-shell\"><pre>$ kubectl get pods\nNAME                            READY     STATUS    RESTARTS   AGE\ntest-dc-0                       1/1       Running   0          1m\ntest-dc-1                       1/1       Running   0          1m\ntest-dc-2                       1/1       Running   0          1m\ntest-dc-3                       1/1       Running   0          1m\ntest-dc-4                       1/1       Running   0          1m</pre></div><p>Similarly we can decrease the size of cluster from 5 back to 3 by changing the size field again and reapplying the change.</p><div class=\"highlight highlight-source-yaml\"><pre>apiVersion: stable.instaclustr.com/v1\nkind: CassandraDataCenter\nmetadata:\n  name: test-dc\nspec:\n  replicas: 3\n  image: \"gcr.io/cassandra-operator/cassandra:latest\"</pre></div><p>Then apply the changes</p><div class=\"highlight highlight-source-shell\"><pre>$ kubectl apply -f example/common/test.yaml</pre></div><h2>Limitations</h2><ul><li>This operator is currently a work in progress and breaking changes are landing in master all the time until we reach our initial release. Here be dragons!</li>\n<li>The operator does not currently manage backups, a command line backup utility is included, tested and built, but not yet managed by the operator.</li>\n<li>Do not use this in production.</li>\n</ul>"}}]}},"pageContext":{"alternative_id":11799}}