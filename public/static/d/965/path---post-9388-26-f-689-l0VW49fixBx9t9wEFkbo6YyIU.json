{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"thejaspm/cfstatsParseVisualize","alternative_id":9388,"content":"import os\n      \n        import re\n      \n        import sys\n      \n         \n      \n        from optparse import OptionParser\n      \n        \n\n      \n        KEYSPACE=\"Keyspace\"\n      \n        COLUMNFAMILY = \"Column Family\";\n      \n        READCOUNT = \"Read Count\";\n      \n        READLATENCY = \"Read Latency\";\n      \n        WRITECOUNT = \"Write Count\";\n      \n        WRITELATENCY = \"Write Latency\";\n      \n        PENDINGTASKS = \"Pending Tasks\";\n      \n        SSTABLECOUNT = \"SSTable count\";\n      \n        SSTABLEIEL = \"SSTables in each level\";\n      \n        SPACEUSEDL = \"Space used (live)\";\n      \n        SPACEUSEDT = \"Space used (total)\";\n      \n        SSTABLECR = \"SSTable Compression Ratio\";\n      \n        NUMKEYS = \"Number of Keys (estimate)\";\n      \n        MEMTABLECC = \"Memtable Columns Count\";\n      \n        MEMTABLEDS = \"Memtable Data Size\";\n      \n        MEMTABLESC = \"Memtable Switch Count\";\n      \n        BLOOMFFP = \"Bloom Filter False Positives\";\n      \n        BLOOMFFR = \"Bloom Filter False Ratio\";\n      \n        BLOOMFSU = \"Bloom Filter Space Used\";\n      \n        COMPACTEDRMINS = \"Compacted row minimum size\";\n      \n        COMPACTEDRMAXS = \"Compacted row maximum size\";\n      \n        COMPACTEDRMEANS = \"Compacted row mean size\";\n      \n        \n\n      \n        \n\n      \n        COLUMN_COUNT = 20\n      \n        \n\n      \n        INDEX_MAP = {\n      \n        \"SSTable count\":1,\n      \n        \"Space used (live)\": 2,\n      \n        \"Space used (total)\": 3,\n      \n        \"Number of Keys (estimate)\": 4,\n      \n        \"Memtable Columns Count\": 5,\n      \n        \"Memtable Data Size\": 6,\n      \n        \"Memtable Switch Count\": 7,\n      \n        \"Read Count\": 8,\n      \n        \"Read Latency\": 9,\n      \n        \"Write Count\": 10,\n      \n        \"Write Latency\": 11,\n      \n        \"Pending Tasks\": 12,\n      \n        \"Bloom Filter False Postives\": 13,\n      \n        \"Bloom Filter False Ratio\": 14,\n      \n        \"Bloom Filter Space Used\": 15,\n      \n        \"Compacted row minimum size\": 16,\n      \n        \"Compacted row maximum size\": 17,\n      \n        \"Compacted row mean size\": 18\n      \n        }\n      \n        \n\n      \n        \n\n      \n        def createHeaderRow():\n      \n            HeaderList  = [\"Row Type\",\"Entity\",\"SSTable count\",\"Space used (live)\",\"Space used (total)\",\"Number of Keys (estimate)\",\"Memtable Columns Count\",\"Memtable Data Size\",\"Memtable Switch Count\",\"Read Count\",\"Read Latency\",\"Write Count\",\"Write Latency\",\"Pending Tasks\",\"Bloom Filter False Postives\",\"Bloom Filter False Ratio\",\"Bloom Filter Space Used\",\"Compacted row minimum size\",\"Compacted row maximum size\",\"Compacted row mean size\"]\n      \n            return HeaderList\n      \n        \n\n      \n        \n\n      \n        def parseAndFormatData(data,fp):\n      \n            lines = data.split('\\n')\n      \n            \n      \n            csvList = [];i=0\n      \n            while i &lt; COLUMN_COUNT:\n      \n                csvList.append('')\n      \n                i += 1\n      \n            fp.write('\"'+'\",\"'.join(createHeaderRow())+'\"'+\"\\n\")\n      \n            for each in lines:\n      \n                if COLUMNFAMILY in each or KEYSPACE in each:\n      \n                    #new row in csv\n      \n                    if csvList[0] != '':\n      \n        \t\tfp.write('\"'+'\",\"'.join(csvList)+'\"'+\"\\n\")\n      \n                        while i &lt; COLUMN_COUNT:\n      \n                            csvList.append('')\n      \n                            i += 1\n      \n        \n\n      \n                    csvList[0],csvList[1]=each.split(':')\n      \n               \t    csvList[0] =  csvList[0].lstrip()\n      \n                else:\n      \n                    if \":\" in each:\n      \n        \t\teach = each.lstrip()\n      \n                        elemntsList = each.split(\":\")\n      \n                        elemntsList[0].lstrip()\n      \n                        if elemntsList[0] in INDEX_MAP.keys():\n      \n        \t\t\tif \"NaN \" in elemntsList[1]:\n      \n        \t\t\t\telemntsList[1]=\"\"\n      \n        \t\tcsvList[INDEX_MAP[elemntsList[0]]+1]=elemntsList[1].strip()\n      \n                        else:\n      \n                            continue\n      \n                    else:\n      \n                        continue\n      \n        \n\n      \n            sys.exit(1) \n      \n         \n      \n        def main():\n      \n            usage = 'usage: %prog --input=&lt;path to a file with cfhistograms output&gt;' + \\\n      \n                     ' --output=&lt;path to the output directory&gt;'\n      \n            parser = OptionParser(usage=usage)\n      \n            parser.add_option('--input', dest='input',\n      \n                          help='Path to a file with cfhistograms output')\n      \n            parser.add_option('--output', dest='output',\n      \n                          help='Path to a file where the graphs are saved')\n      \n         \n      \n            (options, args) = parser.parse_args()\n      \n         \n      \n            if not options.input:\n      \n                print('Error: Missing \"--input\" option')\n      \n                print parser.print_usage()\n      \n                sys.exit(1)\n      \n         \n      \n            if not options.output:\n      \n                print('Error: Missing \"--output\" option')\n      \n                print parser.print_usage()\n      \n                sys.exit(1)\n      \n         \n      \n            if not os.path.exists(options.input) or not \\\n      \n        \tos.path.isfile(options.input):\n      \n                print('--input argument is not a valid file path')\n      \n                sys.exit(2)\n      \n         \n      \n            fp1 = open(options.output, 'wb')\n      \n            with open(options.input, 'r') as fp:\n      \n                print('Processing file...') \n      \n                content = fp.read()\n      \n                parseAndFormatData(content,fp1)\n      \n            fp1.close()\n      \n        main()"}}]}},"pageContext":{"alternative_id":9388}}