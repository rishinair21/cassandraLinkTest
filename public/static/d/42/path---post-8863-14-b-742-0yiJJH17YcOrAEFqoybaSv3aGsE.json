{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"Upgrading to DataStax Enterprise 5.0 | DataStax Upgrade guide","alternative_id":8863,"content":"<p class=\"shortdesc\">Instructions to upgrade to DataStax Enterprise 5.0 from 4.7 or 4.8.</p><p class=\"p\">Follow these instructions to upgrade from DataStax Enterprise 4.7 or 4.8 to 5.0. If you have\n      an earlier version, upgrade to 4.8 before continuing.</p>\n    <div class=\"note attention\" readability=\"12\">Attention: You have probably seen the recommendation to\n      read all the instructions. This is a time when careful review of the upgrade instructions will\n      make a difference. By understanding what to do beforehand, you can ensure a smooth upgrade and\n      avoid pitfalls and frustrations.<p class=\"p\">Read and understand these instructions before\n        upgrading.</p>\n</div>\n    <section class=\"section\">On this page:<ul class=\"ul\" id=\"upgdDSE50__ul_ds2_4zr_g5\"><li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__cstar-version-change\">Apache Cassandra™ version change</a></li>\n      <li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__recommendations\">General recommendations</a></li>\n      <li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__restrictions\">General restrictions and limitations during the upgrade process</a></li>\n      <li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__prepUpg50\">Preparing to upgrade</a></li>\n      <li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__upg50\">Upgrade steps</a></li>\n      <li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__msgsIgnore\">Warning messages during and after upgrade</a></li>\n      </ul></section><section class=\"section\" id=\"upgdDSE50__cstar-version-change\" readability=\"1\"><h2 class=\"title sectiontitle\">Apache  Cassandra™ version change</h2>\n      \n      <div class=\"p\" readability=\"7\">Upgrading from DataStax Enterprise 4.7 or 4.8 to 5.0 includes a major Cassandra version\n        change. <ul class=\"ul\"><li class=\"li\">DataStax Enterprise 5.1 uses Cassandra 3.11.</li>\n          <li class=\"li\">DataStax Enterprise 5.0 uses Cassandra 3.0.</li>\n          <li class=\"li\">DataStax Enterprise 4.7 to 4.8 uses Cassandra 2.1.</li>\n          <li class=\"li\">DataStax Enterprise 4.0 to 4.6 uses Cassandra 2.0.</li>\n        </ul>\nBe sure to follow the recommendations for upgrading the SSTables.</div>\n    </section><section class=\"section\" id=\"upgdDSE50__recommendations\" readability=\"-20\"><h2 class=\"title sectiontitle\">General recommendations</h2>\n      \n      <p class=\"p\">DataStax recommends backing up your data prior to any version upgrade. A\n            backup provides the ability to revert and restore all the data used in the previous\n            version if necessary.</p>\n      <p class=\"p opsc-icon\">OpsCenter provides a\n             that manages enterprise-wide backup and\n            restore operations for DataStax Enterprise clusters.</p>\n    </section><section class=\"section\" id=\"upgdDSE50__restrictions\" readability=\"5\"><h2 class=\"title sectiontitle\">General restrictions and limitations during the upgrade process</h2>\n      \n      <p class=\"p\">Restrictions and limitations apply while a cluster is in a\n          <strong class=\"ph b\">partially upgraded</strong> state. </p>\n      <p class=\"p\">With these exceptions, the cluster continues to work as though it\n        were on the earlier version of DataStax Enterprise until all of the nodes in the cluster are\n        upgraded.</p>\n      <dl class=\"dl\"><dt class=\"dt dlterm\">General upgrade restrictions</dt>\n          <dd class=\"dd\">\n            <ul class=\"ul\" id=\"upgdDSE50__d11e840\"><li class=\"li\" id=\"upgdDSE50__d11e842\"><strong class=\"ph b\">Do not</strong> enable new features.</li>\n              <li class=\"li\" id=\"upgdDSE50__d11e847\">Do not run nodetool repair. If you have the OpsCenter\n                Repair Service configured, turn off the Repair\n                  Service. </li>\n              <li class=\"li\" id=\"upgdDSE50__d11e853\">During the upgrade, do not bootstrap or decommission nodes. </li>\n              <li class=\"li\" id=\"upgdDSE50__d11e856\">Do not issue these types of CQL queries during a rolling restart:\n                  <code data-swiftype-name=\"codeph\" data-swiftype-type=\"text\" class=\"ph codeph\">DDL</code> and <code data-swiftype-name=\"codeph\" data-swiftype-type=\"text\" class=\"ph codeph\">TRUNCATE</code>.</li>\n              <li class=\"li\" id=\"upgdDSE50__d11e865\">During the upgrade, the nodes on different versions might show a schema\n                disagreement.</li>\n              <li class=\"li\" id=\"upgdDSE50__d11e869\">Failure to upgrade SSTables when required results in a significant performance\n                impact and increased disk usage. Upgrading is not complete until the SSTables are\n                upgraded.</li>\n            </ul></dd>\n        \n        \n          <dt class=\"dt dlterm\">Restrictions for DSE Analytic (Hadoop and Spark) nodes</dt>\n          <dd class=\"dd\">\n            <ul class=\"ul\" id=\"upgdDSE50__d11e882\"><li class=\"li\">Do not run analytics jobs until all nodes are upgraded.</li>\n              <li class=\"li\">Kill all Spark worker processes before you stop the node and install the new\n                version.</li>\n            </ul></dd>\n        \n        \n          <dt class=\"dt dlterm\" id=\"upgdDSE50__upgrdSrchLim\">DSE Search (Solr) upgrade restrictions and limitations</dt>\n          <dd class=\"dd\">\n            <ul class=\"ul\" id=\"upgdDSE50__ul_w1g_vgf_cs\"><li class=\"li\">Do not update schemas.</li>\n              <li class=\"li\">Do not reindex DSE Search nodes during upgrade.</li>\n              <li class=\"li\">Do not issue these types of queries during a rolling restart: <code data-swiftype-name=\"codeph\" data-swiftype-type=\"text\" class=\"ph codeph\">DDL</code>\n                or <code data-swiftype-name=\"codeph\" data-swiftype-type=\"text\" class=\"ph codeph\">TRUNCATE</code>.</li>\n              <li class=\"li\">While mixed versions of nodes exist during an upgrade, DataStax Enterprise runs\n                two different servers for backward compatibility. One based on\n                shard_transport_options, the other based on internode_messaging_options. (These\n                options are located in dse.yaml.) After all nodes are upgraded\n                to 5.0, internode_messaging_options are used. The <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/config/configDseYaml.html#configDseYaml__interNode\" target=\"_blank\"> internode_messaging_options</a> are used by\n                several components of DataStax Enterprise. For 5.0 and later, all internode\n                messaging requests use this service.</li>\n            </ul></dd>\n        \n        \n          <dt class=\"dt dlterm\">Restrictions for nodes using any kind of security</dt>\n          <dd class=\"dd\">\n            <ul class=\"ul\" id=\"upgdDSE50__d11e955\"><li class=\"li\">Do not change security credentials or permissions until after the upgrade is\n                complete.</li>\n              <li class=\"li\">If you are not already using Kerberos, do not set up Kerberos authentication\n                before upgrading. First upgrade the cluster, and then set up Kerberos.</li>\n            </ul></dd>\n        \n        \n          <dt class=\"dt dlterm\">Upgrading drivers and possible impact when driver versions are incompatible</dt>\n          <dd class=\"dd\">Be sure to check <a class=\"xref\" href=\"http://docs.datastax.com/en/developer/driver-matrix/doc/common/driverMatrix.html\" target=\"_blank\">driver compatibility</a>. Depending on the driver version, you\n              might need to recompile your client application code. See <a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/upgrdDrivers.html\" title=\"Upgrading the DataStax C/C++, C#, Java, Node.js, PHP, Python, and Ruby drivers.\">Upgrading DataStax drivers</a>.</dd>\n          <dd class=\"dd ddexpand\">During upgrades, you might experience driver-specific impact when clusters have mixed\n            versions of drivers. If your cluster has mixed versions, the protocol version is\n            negotiated with the first host that the driver connects to. To avoid driver version\n            incompatibility during upgrades, use one of these workarounds:<ul class=\"ul\" id=\"upgdDSE50__d11e999\"><li class=\"li\">Force a protocol version at startup. For example, keep the Java driver at v2 while\n                the upgrade is happening. Switch to the Java driver v3 only after the entire cluster\n                is upgraded.</li>\n              <li class=\"li\">Ensure that the list of initial contact points contains only hosts with the oldest\n                driver version. For example, the initial contact points contain only Java driver\n                v2.</li>\n            </ul>\nFor details on protocol version negotiation, see protocol versions with mixed\n            clusters in the Java driver version you're using, for example, <a class=\"xref\" href=\"http://docs.datastax.com/en/developer/java-driver-dse/latest\" target=\"_blank\">Java\n              driver</a>. </dd>\n        \n      </dl></section><section class=\"section\" id=\"upgdDSE50__prepUpg50\" readability=\"1\"><h2 class=\"title sectiontitle\">Preparing to upgrade</h2>\n      \n      <div class=\"p\" readability=\"6\">Follow these steps to prepare each node for upgrading from DataStax Enterprise 4.7 or 4.8\n        to DataStax Enterprise 5.0:<ol class=\"ol\" readability=\"15\"><li class=\"li\" readability=\"2\">Before upgrading, be sure that each node has ample free disk space.\n            <p class=\"p\">The required space depends on the compaction strategy. See <a class=\"xref\" href=\"http://docs.datastax.com/en/dse/5.1/dse-planning/planning/planningHardware.html#planningHardware__disk\" target=\"_blank\">Disk space</a> in <em class=\"ph i\">Planning and testing DataStax\n              Enterprise deployments</em>.</p>\n</li>\n          <li class=\"li\" id=\"upgdDSE50__familarize\">Familiarize yourself with the changes and features in this\n          release: <ul class=\"ul\"><li class=\"li\" id=\"upgdDSE50__d11e240\">Be sure your <a class=\"xref\" href=\"http://docs.datastax.com/en/landing_page/doc/landing_page/supportedPlatforms.html\" target=\"_blank\">platform is supported</a>.</li>\n            <li class=\"li\" id=\"upgdDSE50__d11e246\"><a class=\"xref\" href=\"http://docs.datastax.com/en/cassandra/3.0/cassandra/install/installJDKabout.html\" target=\"_blank\">Oracle Java SE Runtime Environment 8 (JDK)</a>\n                (1.8.0_40 minimum) or <a class=\"xref\" href=\"http://openjdk.java.net/\" target=\"_blank\">OpenJDK 8</a>.\n              Earlier or later versions are not supported.</li>\n            <li class=\"li\">DataStax Enterprise <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/RNdse.html\" target=\"_blank\">5.0 release notes</a>.</li>\n            <li class=\"li\"><em class=\"ph i\">General upgrading advice for any version</em> and <em class=\"ph i\">New features</em> for Apache\n              Cassandra™ 3.0 in <a class=\"xref\" href=\"http://github.com/apache/cassandra/blob/cassandra-3.0/NEWS.txt\" target=\"_blank\">NEWS.txt</a>. Be sure to read the NEWS.txt\n              all the way back to your current version.</li>\n            <li class=\"li\">Apache Cassandra™ changes in <a class=\"xref\" href=\"http://github.com/apache/cassandra/blob/cassandra-3.0/CHANGES.txt\" target=\"_blank\">CHANGES.txt</a>. </li>\n            <li class=\"li\">DataStax Enterprise 5.0 <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/RNcassChanges.html\" target=\"_blank\">production-certified changes</a> to Apache\n              Cassandra.</li>\n            <li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/upgrdDrivers.html\" title=\"Upgrading the DataStax C/C++, C#, Java, Node.js, PHP, Python, and Ruby drivers.\">DataStax driver changes</a>.</li>\n          </ul></li>\n          <li class=\"li\" readability=\"16\">Verify your current product version. If necessary, upgrade to an interim version:\n              \n<table cellpadding=\"4\" cellspacing=\"0\" summary=\"\" id=\"upgdDSE50__versionTable\" class=\"table\" frame=\"border\" border=\"1\" rules=\"all\"><colgroup><col/><col/></colgroup><tbody class=\"tbody\" readability=\"35\"><tr readability=\"2\"><td class=\"entry cellrowborder\" headers=\"d7765e387 \">DataStax Enterprise 4.7 or 4.8</td>\n                    <td class=\"entry cellrowborder\" headers=\"d7765e390 \">DataStax Enterprise 5.0</td>\n                  </tr><tr readability=\"4\"><td class=\"entry cellrowborder\" headers=\"d7765e387 \">DataStax Enterprise 4.0, 4.5, or 4.6</td>\n                    <td class=\"entry cellrowborder\" headers=\"d7765e390 \">DataStax Enterprise 4.8</td>\n                  </tr><tr readability=\"2\"><td class=\"entry cellrowborder\" headers=\"d7765e387 \">DataStax Community or open source Apache Cassandra™ 2.0.x</td>\n                    <td class=\"entry cellrowborder\" headers=\"d7765e390 \">DataStax Enterprise 4.8</td>\n                  </tr><tr readability=\"2\"><td class=\"entry cellrowborder\" headers=\"d7765e387 \">DataStax Community 3.0.x</td>\n                    <td class=\"entry cellrowborder\" headers=\"d7765e390 \">No interim version required.</td>\n                  </tr><tr readability=\"2\"><td class=\"entry cellrowborder\" headers=\"d7765e387 \">DataStax Distribution of Apache Cassandra™ 3.x</td>\n                    <td class=\"entry cellrowborder\" headers=\"d7765e390 \">Upgrade not available.</td>\n                  </tr></tbody></table></li>\n          <li class=\"li\" readability=\"11\">Upgrade the SSTables on each node to ensure that all SSTables\n          are on the current version. <div class=\"p\" readability=\"10\">This is required for DataStax Enterprise upgrades that\n            include  changes.<p>Warning: Failure to upgrade SSTables when required results in a significant\n              performance impact and increased disk usage.\n              </p>\n</div>\n<pre class=\"pre screen\">$ nodetool upgradesstables</pre>\n<p class=\"p\">If the SSTables are already on the current version, the\n              command returns immediately and no action is taken. See <a class=\"xref\" href=\"http://docs.datastax.com/en/dse/5.1/dse-admin/datastax_enterprise/tools/toolsSStables/ToolsSSTableupgrade.html\" target=\"_blank\">SSTable compatibility and upgrade\n              version</a>.</p>\n<p class=\"p\">Use the <code data-swiftype-name=\"codeph\" data-swiftype-type=\"text\" class=\"ph codeph\">--jobs</code> option to\n              set the number of SStables that upgrade simultaneously. The default setting is 2,\n              which minimizes impact on the cluster. Set to 0 to use all available compaction\n              threads.</p>\n</li>\n          <li class=\"li\" readability=\"8\">Verify the Java runtime version and upgrade to the recommended\n            version.<pre class=\"pre screen\">$ java -version</pre>\n<p class=\"p\" id=\"upgdDSE50__d11e62\">The latest version of <a class=\"xref\" href=\"http://docs.datastax.com/en/cassandra/3.0/cassandra/install/installJDKabout.html\" target=\"_blank\">Oracle Java SE Runtime Environment 8 (JDK)</a> (1.8.0_40 minimum)\n            or <a class=\"xref\" href=\"http://openjdk.java.net/\" target=\"_blank\">OpenJDK 8</a>\n            is recommended. The JDK is recommended for development and production systems. The JDK\n            provides useful troubleshooting tools that are not in the JRE, such as jstack, jmap,\n            jps, and jstat.</p>\n</li>\n          <li class=\"li\">Run <a class=\"xref\" href=\"http://docs.datastax.com/en/cassandra/3.0/cassandra/tools/toolsRepair.html\" target=\"_blank\">nodetool repair</a> to ensure that data on each replica is consistent with data on\n          other nodes. </li>\n          \n          <li class=\"li\" id=\"upgdDSE50__keyName\" readability=\"5\"><strong class=\"ph b\">DSE Search partition key names</strong><div class=\"p\" readability=\"17\">The partition key names of COMPACT\n              STORAGE tables backed by DSE Search indexes match the uniqueKey\n              in schema.xml. For example, consider the following table is\n              created with compact\n              storage:<pre>CREATE TABLE keyspace_name.table_name (key text PRIMARY KEY, foo text, solr_query text) \nWITH COMPACT STORAGE</pre>and\n              the Solr schema.xml\n              is:<pre>...\n&lt;uniqueKey&gt;id&lt;/uniqueKey&gt;\n...</pre>then rename the key\n              in the table to match the\n              schema:<pre class=\"pre screen\">ALTER TABLE ks.table RENAME key TO id;</pre>\n</div>\n</li>\n          <li class=\"li\" readability=\"1\">Back up the  files you use to a folder\n            that is not in the directory where you normally run commands. <p class=\"p\">The configuration files are overwritten with default values during installation of the\n            new version. </p>\n</li>\n        </ol></div>\n    </section><section class=\"section\" id=\"upgdDSE50__upg50\" readability=\"5\"><h2 class=\"title sectiontitle\">Upgrade steps</h2>\n      \n      <p>Tip: The <a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSEinstaller.html\" title=\"DataStax Enterprise upgrade instructions for the DataStax Installer.\">DataStax installer</a>\n        upgrades DataStax Enterprise and automatically performs many upgrade tasks. </p>\n      <div class=\"p\" readability=\"7\">Follow these steps on each node to upgrade from DataStax Enterprise 4.7 or 4.8 to DataStax\n        Enterprise 5.0. Some <a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__msgsIgnore\">warning messages are displayed during and\n          after upgrade</a>.<ol class=\"ol\" id=\"upgdDSE50__stepUpg\" readability=\"18\"><li class=\"li\">Upgrade order matters. Upgrade nodes in this order:<ul class=\"ul\" readability=\"2\"><li class=\"li\">In multiple datacenter clusters, upgrade every node in one datacenter before\n              upgrading another datacenter.</li>\n            <li class=\"li\" readability=\"5\">Upgrade the seed nodes within a datacenter first.<p class=\"p\">For DSE Analytics nodes using\n                DSE Hadoop, upgrade the Job Tracker node first. Then upgrade Hadoop nodes, followed\n                by Spark nodes.</p>\n</li>\n            <li class=\"li\">Upgrade types in this order:<ol class=\"ol\" type=\"a\"><li class=\"li\">DSE Analytics nodes or datacenters</li>\n                <li class=\"li\">Transactional/DSE Graph nodes or datacenters</li>\n                <li class=\"li\">DSE Search nodes or datacenters</li>\n              </ol></li>\n          </ul>\nWith a few exceptions, the cluster continues to work as\n            though it were on the earlier version of DataStax Enterprise until all of the nodes in\n            the cluster are upgraded. Upgrade and restart the nodes one at a time. Other nodes in\n            the cluster continue to operate at the earlier version until all nodes are\n            upgraded.</li>\n          <li class=\"li\"><strong class=\"ph b\">DSE Analytics nodes:</strong> Kill all Spark worker processes. </li>\n          <li class=\"li\"><strong class=\"ph b\">DSE Search nodes:</strong> Review these considerations and take appropriate\n            actions:</li>\n          <li class=\"li\" readability=\"6\">Run <a class=\"xref\" href=\"http://docs.datastax.com/en/cassandra/3.0/cassandra/tools/toolsDrain.html\" target=\"_blank\">nodetool drain</a> to flush the commit log of the old\n            installation:<pre class=\"pre screen\">$ nodetool drain -h <var class=\"keyword varname\">hostname</var></pre>\n<div class=\"p\" readability=\"16\">This\n            step saves time when nodes start up after the upgrade and prevents DSE Search nodes from\n            having to reindex data. <p>Important:  This step is mandatory when upgrading\n              between major Cassandra versions that change SSTable formats, rendering commit logs\n              from the previous version incompatible with the new version.</p>\n</div>\n</li>\n          <li class=\"li\"><a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/admin/startStopDseToc.html\" target=\"_blank\">Stop the node</a>:</li>\n          <li class=\"li\" readability=\"5\">Use the appropriate method to install the new product version on a\n            <a class=\"xref\" href=\"http://docs.datastax.com/en/landing_page/doc/landing_page/supportedPlatforms.html\" target=\"_blank\">supported platform</a>:<ul class=\"ul\" id=\"upgdDSE50__d11e559\"><li class=\"li\">RHEL: <a class=\"xref\" href=\"http://docs.datastax.com/en/archived/datastax_enterprise/4.6/datastax_enterprise/install/installRHELdse.html\" target=\"_blank\">4.6</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/4.7/datastax_enterprise/install/installRHELdse.html\" target=\"_blank\">4.7</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/4.8/datastax_enterprise/install/installRHELdse.html\" target=\"_blank\">4.8</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/install/installRHELdse.html\" target=\"_blank\">5.0</a></li>\n            <li class=\"li\">Debian: <a class=\"xref\" href=\"http://docs.datastax.com/en/archived/datastax_enterprise/4.6/datastax_enterprise/install/installDEBdse.html\" target=\"_blank\">4.6</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/4.7/datastax_enterprise/install/installDEBdse.html\" target=\"_blank\">4.7</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/4.8/datastax_enterprise/install/installDEBdse.html\" target=\"_blank\">4.8</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/install/installDEBdse.html\" target=\"_blank\">5.0</a>\n            </li>\n            <li class=\"li\">Tarball: <a class=\"xref\" href=\"http://docs.datastax.com/en/archived/datastax_enterprise/4.6/datastax_enterprise/install/installTARdse.html\" target=\"_blank\">4.6</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/4.7/datastax_enterprise/install/installTARdse.html\" target=\"_blank\">4.7</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/4.8/datastax_enterprise/install/installTARdse.html\" target=\"_blank\">4.8</a>, <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/install/installTARdse.html\" target=\"_blank\">5.0</a>\n            </li>\n          </ul><p>Note: Install the new product version using the same installation type that is on the\n            system. The upgrade proceeds with installation regardless of the installation type and\n            might result in issues. </p>\n</li>\n          <li class=\"li\" readability=\"4\">If the cluster will run Hadoop in a Kerberos secure environment, change\n            the task-controller file ownership to root and access permissions\n            to 4750. For\n              example:<pre class=\"pre screen\">$ sudo chown root /usr/share/dse/resources/hadoop/native/Linux-amd64-64/bin/task-controller\n$ sudo chmod 4750 /usr/share/dse/resources/hadoop/native/Linux-amd64-64/bin/task-controller</pre>\n<p class=\"p\">Package\n              installations only: The default location of the <code data-swiftype-name=\"codeph\" data-swiftype-type=\"text\" class=\"ph codeph\">task-controller</code> file\n              should be\n                /usr/share/dse/resources/hadoop/native/Linux-amd64-64/bin/task-controller.</p>\n</li>\n          <li class=\"li\" id=\"upgdDSE50__stepConfNew\">To configure the new product version:<ol class=\"ol\" type=\"a\"><li class=\"li\">Compare your backup  files to the\n                new configuration files: <ul class=\"ul\"><li class=\"li\">Look for any deprecated, removed, or changed settings.</li>\n                  <li class=\"li\">Be sure you are <a class=\"xref\" href=\"http://docs.datastax.com/en/upgrade/doc/upgrade/datastax_enterprise/upgdDSE50.html#upgdDSE50__familarize\">familiar</a> with the\n                    Apache Cassandra and DataStax Enterprise changes and features in the new\n                    release. </li>\n                </ul></li>\n              <li class=\"li\">Merge the applicable modifications into the new version.</li>\n            </ol></li>\n          <li class=\"li\">Start the node.<ul class=\"ul\"><li class=\"li\">Installer-Services and Package installations: See <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/admin/startDseService.html\" target=\"_blank\">Starting DataStax Enterprise as a\n              service</a>.</li>\n            <li class=\"li\">Installer-No Services and Tarball installations: See <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/admin/startDseStandalone.html\" target=\"_blank\">Starting DataStax Enterprise as a stand-alone\n                process</a>.</li>\n          </ul></li>\n          <li class=\"li\">Verify that the upgraded datacenter names match the datacenter\n          names in the keyspace schema definition:<pre class=\"pre screen\">$ nodetool status</pre>\n</li>\n          <li class=\"li\" readability=\"13\">Review the logs for warnings, errors, and exceptions. Because DataStax Enterprise 5.0 uses\n            Cassandra 3.0, the output.log might include warnings about the following:<ul class=\"ul\"><li class=\"li\">sstable_compression</li>\n              <li class=\"li\">chunk_length_kb </li>\n              <li class=\"li\">memory_allocator</li>\n              <li class=\"li\">memtable_allocation_type</li>\n              <li class=\"li\">offheap_objects</li>\n              <li class=\"li\">netty_server_port - used only during the upgrade to 5.0. After all nodes are\n                running 5.0, requests that are coordinated by this node no longer contact other\n                nodes on this port. Instead requests use inter-node messaging options. The <a class=\"xref\" href=\"http://docs.datastax.com/en/datastax_enterprise/5.0/datastax_enterprise/config/configDseYaml.html#configDseYaml__interNode\" target=\"_blank\"> internode_messaging_options</a> are used by\n                several components of DataStax Enterprise. For 5.0 and later, all internode\n                messaging requests use this service.</li>\n            </ul><p class=\"p\">Warnings, errors, and exceptions are frequently found in the\n            logs when starting up an upgraded node. Some of these log entries are informational to\n            help you execute specific upgrade-related steps. If you find unexpected warnings,\n            errors, or exceptions, contact <a class=\"xref\" href=\"https://support.datastax.com/hc/en-us\" target=\"_blank\">DataStax Support</a>.</p>\n<p class=\"p\">During upgrade of DSE Analytics\n              nodes, exceptions about the Task Tracker are logged in the nodes that are not yet\n              upgraded to 5.0. The jobs succeed after the entire cluster is upgraded. </p>\n</li>\n          <li class=\"li\" id=\"upgdDSE50__stepRepeat\">Repeat the upgrade on each node in the cluster following the\n            recommended .</li>\n          <li class=\"li\" readability=\"6\">After all nodes are upgraded, drop the following legacy tables: system_auth.users,\n            system_auth.credentials and system_auth.permissions.<p class=\"p\">As described in Cassandra <a class=\"xref\" href=\"http://github.com/apache/cassandra/blob/cassandra-3.0/NEWS.txt#L310-L331\" target=\"_blank\">NEWS.txt</a>, the authentication and authorization\n              subsystems have been redesigned to support role-based access control (RBAC), which\n              results in a change to the schema of the system_auth keyspace. </p>\n</li>\n          <li class=\"li\" id=\"upgdDSE50__stepSSTablesAfterDSE50\" readability=\"11\">After the new version is install on all nodes, upgrade the\n            SSTables: <pre class=\"pre screen\">$ nodetool upgradesstables</pre>\n<p>Warning: Failure to\n              upgrade SSTables when required results in a significant performance impact and\n              increased disk usage. Upgrading is not complete until the SSTables are\n              upgraded.</p>\n<p class=\"p\">Use the <code data-swiftype-name=\"codeph\" data-swiftype-type=\"text\" class=\"ph codeph\">--jobs</code> option to\n              set the number of SStables that upgrade simultaneously. The default setting is 2,\n              which minimizes impact on the cluster. Set to 0 to use all available compaction\n              threads.</p>\n</li>\n          <li class=\"li\">For multiple datacenter deployments, change the replication factor of the\n            system_distributed keyspace to NetworkTopologyStrategy.  </li>\n          <li class=\"li\">If you use the OpsCenter Repair Service, turn on the Repair Service. </li>\n        </ol></div>\n      \n    </section><section class=\"section\" readability=\"0\"/>"}}]}},"pageContext":{"alternative_id":8863}}