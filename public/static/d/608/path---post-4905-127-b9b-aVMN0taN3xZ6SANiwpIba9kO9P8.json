{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"DataStax NodeJS Driver","alternative_id":4905,"content":"<p>A modern, <a href=\"https://github.com/datastax/nodejs-driver#features\">feature-rich</a> and highly tunable Node.js client library for Apache Cassandra (1.2+) using exclusively Cassandra's binary protocol and Cassandra Query Language v3. <em>Use the <a href=\"https://github.com/datastax/nodejs-dse-driver\">DSE Node.js driver</a> for better compatibility and support for DataStax Enterprise</em>.</p><h2><a href=\"https://github.com/datastax/nodejs-driver#installation\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-installation\"></a>Installation</h2><div class=\"highlight highlight-source-shell\"><pre>$ npm install cassandra-driver</pre></div><p><a href=\"https://travis-ci.org/datastax/nodejs-driver\"><img src=\"https://camo.githubusercontent.com/eb00101df16c48e8c49bad714207b207be5feac1/68747470733a2f2f7472617669732d63692e6f72672f64617461737461782f6e6f64656a732d6472697665722e7376673f6272616e63683d6d6173746572\" alt=\"Build Status\" data-canonical-src=\"https://travis-ci.org/datastax/nodejs-driver.svg?branch=master\" /></a> <a href=\"https://ci.appveyor.com/project/datastax/nodejs-driver/branch/master\"><img src=\"https://camo.githubusercontent.com/964cf2b4f7f404c95ca883916f62576cd8915f30/68747470733a2f2f63692e6170707665796f722e636f6d2f6170692f70726f6a656374732f7374617475732f6d32317432746664706d6b6a6578316c2f6272616e63682f6d61737465723f7376673d74727565\" alt=\"Build status\" data-canonical-src=\"https://ci.appveyor.com/api/projects/status/m21t2tfdpmkjex1l/branch/master?svg=true\" /></a></p><h2><a href=\"https://github.com/datastax/nodejs-driver#features\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-features\"></a>Features</h2><ul><li>Simple, Prepared, and <a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/batch/\">Batch</a> statements</li>\n<li>Asynchronous IO, parallel execution, request pipelining</li>\n<li><a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/connection-pooling/\">Connection pooling</a></li>\n<li>Auto node discovery</li>\n<li>Automatic reconnection</li>\n<li>Configurable <a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/tuning-policies/#load-balancing-policy\">load balancing</a> and <a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/tuning-policies/#retry-policy\">retry policies</a></li>\n<li>Works with any cluster size</li>\n<li>Both <a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/promise-callback/\">promise and callback-based API</a></li>\n<li><a href=\"https://github.com/datastax/nodejs-driver#row-streaming-and-pipes\">Row streaming and pipes</a></li>\n</ul><h2><a href=\"https://github.com/datastax/nodejs-driver#documentation\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-documentation\"></a>Documentation</h2><ul><li><a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/\">Documentation index</a></li>\n<li><a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/datatypes/\">CQL types to JavaScript types</a></li>\n<li><a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/api/\">API docs</a></li>\n<li><a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/faq/\">FAQ</a></li>\n</ul><h2><a href=\"https://github.com/datastax/nodejs-driver#getting-help\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-getting-help\"></a>Getting Help</h2><p>You can use the <a href=\"https://groups.google.com/a/lists.datastax.com/forum/#!forum/nodejs-driver-user\">project mailing list</a> or create a ticket on the <a href=\"https://datastax-oss.atlassian.net/projects/NODEJS/issues\">Jira issue tracker</a>. Additionally, you can use the <code>#datastax-drivers</code> channel in the <a href=\"https://academy.datastax.com/slack\">DataStax Academy Slack</a>.</p><h2><a href=\"https://github.com/datastax/nodejs-driver#basic-usage\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-basic-usage\"></a>Basic usage</h2><div class=\"highlight highlight-source-js\"><pre>const cassandra = require('cassandra-driver');\nconst client = new cassandra.Client({ contactPoints: ['h1', 'h2'], keyspace: 'ks1' });\nconst query = 'SELECT name, email FROM users WHERE key = ?';\nclient.execute(query, [ 'someone' ])\n  .then(result =&gt; console.log('User with email %s', result.rows[0].email));</pre></div><p>Alternatively, you can use the callback-based execution for all asynchronous methods of the API.</p><div class=\"highlight highlight-source-js\"><pre>client.execute(query, [ 'someone' ], function(err, result) {\n  assert.ifError(err);\n  console.log('User with email %s', result.rows[0].email);\n});</pre></div><h3><a href=\"https://github.com/datastax/nodejs-driver#prepare-your-queries\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-prepare-your-queries\"></a>Prepare your queries</h3><p>Using prepared statements provides multiple benefits.\nPrepared statements are parsed and prepared on the Cassandra nodes and are ready for future execution.\nAlso, when preparing, the driver retrieves information about the parameter types which\n<strong>allows an accurate mapping between a JavaScript type and a Cassandra type</strong>.</p><p>The driver will prepare the query once on each host and execute the statement with the bound parameters.</p><div class=\"highlight highlight-source-js\"><pre>// Use query markers (?) and parameters\nconst query = 'UPDATE users SET birth = ? WHERE key=?'; \nconst params = [ new Date(1942, 10, 1), 'jimi-hendrix' ];\n// Set the prepare flag in the query options\nclient.execute(query, params, { prepare: true })\n  .then(result =&gt; console.log('Row updated on the cluster'));</pre></div><h3><a href=\"https://github.com/datastax/nodejs-driver#row-streaming-and-pipes\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-row-streaming-and-pipes\"></a>Row streaming and pipes</h3><p>When using <code>#eachRow()</code> and <code>#stream()</code> methods, the driver parses each row as soon as it is received,\nyielding rows without buffering them.</p><div class=\"highlight highlight-source-js\"><pre>// Reducing a large result\nclient.eachRow('SELECT time, val FROM temperature WHERE station_id=', ['abc'],\n  function(n, row) {\n    // The callback will be invoked per each row as soon as they are received\n    minTemperature = Math.min(row.val, minTemperature);\n  },\n  function (err) {\n    assert.ifError(err);\n  }\n);</pre></div><p>The <code>#stream()</code> method works in the same way but instead of callback it returns a <a href=\"http://nodejs.org/api/stream.html#stream_class_stream_readable\">Readable Streams2</a> object\nin <code>objectMode</code> that emits instances of <code>Row</code>.\nIt can be <strong>piped</strong> downstream and provides automatic pause/resume logic (it buffers when not read).</p><div class=\"highlight highlight-source-js\"><pre>client.stream('SELECT time, val FROM temperature WHERE station_id=', [ 'abc' ])\n  .on('readable', function () {\n    // 'readable' is emitted as soon a row is received and parsed\n    var row;\n    while (row = this.read()) {\n      console.log('time %s and value %s', row.time, row.val);\n    }\n  })\n  .on('end', function () {\n    // Stream ended, there aren't any more rows\n  })\n  .on('error', function (err) {\n    // Something went wrong: err is a response error from Cassandra\n  });</pre></div><h3><a href=\"https://github.com/datastax/nodejs-driver#user-defined-types\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-user-defined-types\"></a>User defined types</h3><p><a href=\"http://cassandra.apache.org/doc/latest/cql/types.html#udts\">User defined types (UDT)</a> are represented as JavaScript objects.</p><p>For example:\nConsider the following UDT and table</p><div class=\"highlight highlight-source-sql\"><pre>CREATE TYPE address (\n  street text,\n  city text,\n  state text,\n  zip int,\n  phones set&lt;text&gt;\n);\nCREATE TABLE users (\n  name text PRIMARY KEY,\n  email text,\n  address frozen&lt;address&gt;\n);</pre></div><p>You can retrieve the user address details as a regular JavaScript object.</p><div class=\"highlight highlight-source-js\"><pre>const query = 'SELECT name, address FROM users WHERE key = ?';\nclient.execute(query, [ key ], { prepare: true })\n  .then(result =&gt; {\n    const row = result.first();\n    const address = row.address;\n    console.log('User lives in %s, %s - %s', address.street, address.city, address.state); \n  });</pre></div><p>Read more information  about using <a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/datatypes/udts/\">UDTs with the Node.js Driver</a>.</p><h3><a href=\"https://github.com/datastax/nodejs-driver#paging\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-paging\"></a>Paging</h3><p>All driver methods use a default <code>fetchSize</code> of 5000 rows, retrieving only first page of results up to a\nmaximum of 5000 rows to shield an application against accidentally large result sets. To retrieve the following\nrecords you can use the <code>autoPage</code> flag in the query options of <code>#eachRow()</code> and <code>#stream()</code> methods.</p><div class=\"highlight highlight-source-js\"><pre>//Imagine a column family with millions of rows\nconst query = 'SELECT * FROM largetable';\nclient.eachRow(query, [], { autoPage: true }, function (n, row) {\n  // This function will be invoked per each of the rows in all the table\n}, endCallback);</pre></div><h3><a href=\"https://github.com/datastax/nodejs-driver#batch-multiple-statements\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-batch-multiple-statements\"></a>Batch multiple statements</h3><p>You can execute multiple statements in a batch to update/insert several rows atomically even in different column families.</p><div class=\"highlight highlight-source-js\"><pre>const queries = [\n  {\n    query: 'UPDATE user_profiles SET email=? WHERE key=?',\n    params: [ emailAddress, 'hendrix' ]\n  },\n  {\n    query: 'INSERT INTO user_track (key, text, date) VALUES (?, ?, ?)',\n    params: [ 'hendrix', 'Changed email', new Date() ]\n  }\n];\nclient.batch(queries, { prepare: true })\n  .then(result =&gt; console.log('Data updated on cluster'));</pre></div><hr /><h2><a href=\"https://github.com/datastax/nodejs-driver#data-types\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-data-types\"></a>Data types</h2><p>There are few data types defined in the ECMAScript specification, this usually represents a problem when you are trying\nto deal with data types that come from other systems in JavaScript.</p><p>The driver supports all the CQL data types in Apache Cassandra (3.0 and below) even for types with no built-in\nJavaScript representation, like decimal, varint and bigint. Check the documentation on working with\n<a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/datatypes/numerical/\">numerical values</a>, <a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/datatypes/uuids/\">uuids</a> and <a href=\"http://docs.datastax.com/en/developer/nodejs-driver/latest/features/datatypes/collections/\">collections</a>.</p><h2><a href=\"https://github.com/datastax/nodejs-driver#logging\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-logging\"></a>Logging</h2><p>Instances of <code>Client()</code> are <code>EventEmitter</code> and emit <code>log</code> events:</p><div class=\"highlight highlight-source-js\"><pre>client.on('log', function(level, className, message, furtherInfo) {\n  console.log('log event: %s -- %s', level, message);\n});</pre></div><p>The <code>level</code> being passed to the listener can be <code>verbose</code>, <code>info</code>, <code>warning</code> or <code>error</code>.</p><h2><a href=\"https://github.com/datastax/nodejs-driver#compatibility\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-compatibility\"></a>Compatibility</h2><ul><li>Apache Cassandra versions 2.0 and above.</li>\n<li>DataStax Enterprise versions 4.5 and above.</li>\n<li>Node.js versions 0.10 and above.</li>\n</ul><p>Note: DataStax products do not support big-endian systems.</p><h2><a href=\"https://github.com/datastax/nodejs-driver#feedback-requested\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-feedback-requested\"></a>Feedback Requested</h2><p><strong>Help us focus our efforts!</strong> Provide your input on the <a href=\"http://goo.gl/forms/f216tY3Ebr\">Platform and Runtime Survey</a> (we kept it short).</p><h2><a href=\"https://github.com/datastax/nodejs-driver#credits\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-credits\"></a>Credits</h2><p>This driver is based on the original work of <a href=\"https://github.com/jorgebay\">Jorge Bay</a> on <a href=\"https://github.com/jorgebay/node-cassandra-cql\">node-cassandra-cql</a> and adds a series of advanced features that are common across all other <a href=\"https://github.com/datastax\">DataStax drivers</a> for Apache Cassandra.</p><p>The development effort to provide an up to date, high performance, fully featured Node.js Driver for Apache Cassandra will continue on this project, while <a href=\"https://github.com/jorgebay/node-cassandra-cql\">node-cassandra-cql</a> will be discontinued.</p><h2><a href=\"https://github.com/datastax/nodejs-driver#license\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-license\"></a>License</h2><p>Copyright 2014-2017 DataStax</p><p>Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p><p><a href=\"http://www.apache.org/licenses/LICENSE-2.0\">http://www.apache.org/licenses/LICENSE-2.0</a></p><p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>"}}]}},"pageContext":{"alternative_id":4905}}