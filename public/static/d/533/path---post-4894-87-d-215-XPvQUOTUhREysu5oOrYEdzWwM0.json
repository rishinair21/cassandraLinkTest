{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"Docker-Cassandra","alternative_id":4894,"content":"<p>This repository contains a set of scripts and configuration files to run a Cassandra cluster\nfrom <a href=\"https://www.docker.io/\">Docker</a> containers. The current version of this repository is\nconfigured to create a Cassandra 1.2 or 2.0 image and cluster.</p><p>Example:</p><p><a href=\"https://camo.githubusercontent.com/11ba2859ff53686f3a22a8eb29e63a811a1e25cd/68747470733a2f2f692e696d6775722e636f6d2f705338747761332e676966\" target=\"_blank\"><img src=\"https://camo.githubusercontent.com/11ba2859ff53686f3a22a8eb29e63a811a1e25cd/68747470733a2f2f692e696d6775722e636f6d2f705338747761332e676966\" alt=\"Sample session\" data-canonical-src=\"https://i.imgur.com/pS8twa3.gif\" /></a></p><p>Cassandra nodes are created with their own IP address and configured hostname:</p><pre>$ ./start-cluster.sh 2.0.3 3\nStarting node 1\nStarting node 2\nStarting node 3\n$ ./client.sh 2.0.3 nodetool -h cass1 status\nDatacenter: datacenter1\n=======================\nStatus=Up/Down\n|/ State=Normal/Leaving/Joining/Moving\n--  Address        Load       Tokens  Owns   Host ID                               Rack\nUN  192.168.100.3  40.84 KB   256     34.9%  9d4a223f-e80e-4b50-b379-0705b1c8971d  rack1\nUN  192.168.100.1  38.93 KB   256     33.7%  5128dcb0-14d0-4d17-9b53-acc8f9a0844b  rack1\nUN  192.168.100.2  30.92 KB   256     31.4%  8e6faaba-601f-4812-a33b-05ceaecf1159  rack1\n</pre><p>Note that the nodes might take about 30 seconds to show up as they join the Cassandra ring.</p><p>The shell scripts all assume that you have <code>sudo</code> privilege.</p><h2><a href=\"https://github.com/nicolasff/docker-cassandra#getting-started\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-getting-started\"></a>Getting started</h2><h3><a href=\"https://github.com/nicolasff/docker-cassandra#1-check-out-this-repository\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-1-check-out-this-repository\"></a>1. Check out this repository</h3><pre>$ git clone https://github.com/nicolasff/docker-cassandra.git\n$ cd docker-cassandra\n</pre><h3><a href=\"https://github.com/nicolasff/docker-cassandra#2-install-pipework\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-2-install-pipework\"></a>2. Install pipework</h3><p>Make sure that the bundled script <code>pipework</code> is in your path. You can install it with:</p><pre>$ sudo cp install/bin/pipework /usr/bin/\n</pre><p>The latest version is on GitHub at <a href=\"https://github.com/jpetazzo/pipework\">https://github.com/jpetazzo/pipework</a>.</p><h3><a href=\"https://github.com/nicolasff/docker-cassandra#3-create-a-docker-image-for-cassandra\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-3-create-a-docker-image-for-cassandra\"></a>3. Create a Docker image for Cassandra</h3><p>To create a Cassandra 2.0.3 image and tag it, run:</p><pre>$ make image VERSION=2.0.3\n</pre><p>You should then see it appear in your list of Docker images:</p><pre>$ sudo docker images\nREPOSITORY          TAG                 ID                  CREATED              SIZE\ncassandra           2.0.3              b9ba84a33bb5        About a minute ago   12.29 kB (virtual 404.7 MB)\n$ ./list-images.sh\n2.0.3\n</pre><h3><a href=\"https://github.com/nicolasff/docker-cassandra#4-start-a-cluster\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-4-start-a-cluster\"></a>4. Start a cluster</h3><p>Run <code>./start-cluster.sh 2.0.3 3</code> to create a cluster of 3 nodes running Cassandra 2.0.3. They are given an IP address and name each, from <code>cass1</code> (<code>192.168.100.1</code>) to <code>cass3</code> (<code>192.168.100.3</code>).</p><p>Run <code>sudo docker ps</code> to list your Cassandra nodes:</p><pre>$ sudo docker ps\nID                  IMAGE               COMMAND                CREATED             STATUS              PORTS\n99d67692f535        cassandra:2.0.3    /usr/bin/start-cassa   10 minutes ago      Up 10 minutes       49332-&gt;9160         \nfe7e2b13cb9e        cassandra:2.0.3    /usr/bin/start-cassa   10 minutes ago      Up 10 minutes       49331-&gt;9160         \nf21da380b00c        cassandra:2.0.3    /usr/bin/start-cassa   10 minutes ago      Up 10 minutes       49330-&gt;9160  \n</pre><h3><a href=\"https://github.com/nicolasff/docker-cassandra#5-connect-to-your-cluster\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-5-connect-to-your-cluster\"></a>5. Connect to your cluster</h3><p>Cassandra nodes expose port 9160 for Thrift. Use <code>sudo docker port &lt;container-id&gt; 9160</code> or <code>sudo docker ps</code> to find the local port it is mapped to.</p><p><code>client.sh</code> creates a docker container with access to the Cassandra cluster network (<code>192.168.100.0/24</code>). The first client is given the name <code>cass254</code>\nwith IP <code>192.168.100.254</code>, the next one <code>cass253</code>, etc. Names are reused when client containers are stopped.</p><p><code>client.sh</code> runs any command that is passed to it, e.g. <code>nodetool</code>, <code>cassandra-cli</code>, <code>cqlsh</code>... You can also open a shell with <code>./client.sh 2.0.3 bash</code>.</p><h3><a href=\"https://github.com/nicolasff/docker-cassandra#6-terminate-your-cluster\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-6-terminate-your-cluster\"></a>6. Terminate your cluster</h3><pre>$ ./stop-cluster.sh 2.0.3\nKilling and removing containers 99d67692f535 fe7e2b13cb9e f21da380b00c\n$ sudo docker ps\nID                  IMAGE               COMMAND             CREATED             STATUS              PORTS\n</pre><h2><a href=\"https://github.com/nicolasff/docker-cassandra#licensing-and-contributions\" aria-hidden=\"true\" class=\"anchor\" id=\"user-content-licensing-and-contributions\"></a>Licensing and contributions</h2><p>This set of scripts and configuration files is released under the <a href=\"https://github.com/nicolasff/docker-cassandra/blob/master/LICENSE\">Apache 2.0 License</a>.\n<code>pipework</code> is Copyright 2013 <a href=\"https://github.com/jpetazzo\">Jérôme Petazzoni</a> and distributed under the Apache 2.0 license.</p><p>Contributions and suggestions welcome <a href=\"https://github.com/nicolasff/docker-cassandra/issues\">on GitHub</a> or <a href=\"https://twitter.com/yowgi\">on Twitter</a>.</p>"}}]}},"pageContext":{"alternative_id":4894}}