{"data":{"allAnantCassandralinks":{"edges":[{"node":{"title":"Spark SQL cassandra delete records","alternative_id":12391,"content":"<div class=\"vote\"><h3>Vote count:&#13;\n        &#13;\n        0&#13;\n        &#13;\n&#13;\n        &#13;\n        &#13;\n&#13;\n&#13;\n&#13;\n</h3></div><div class=\"post-text\" itemprop=\"text\">&#13;\n&#13;\n<p>Is there a way to delete some records based on a select query?</p>\n<p>I have this query,</p>\n<p><code>Select min(id) from ID having count(*)&gt;1</code> which will show the duplicates. I need to get those ids and delete them. How can I do it in spark sql?</p></div><div class=\"user-action-time\">&#13;\n        asked Apr 28 '16 at 4:48&#13;</div><div class=\"user-details\">&#13;\n        <a href=\"https://stackoverflow.com/users/1732516/ashk\">ashK</a>&#13;\n        <div class=\"-flair\">&#13;\n            1881214&#13;\n        </div>&#13;</div><h2 data-answercount=\"1\">&#13;\n                                1 Answer&#13;\n                                1&#13;</h2><div class=\"vote\"><h3>Vote count:&#13;\n        &#13;\n        0&#13;\n        &#13;\n&#13;\n&#13;\n&#13;\n&#13;\n&#13;\n</h3></div><div class=\"post-text\" itemprop=\"text\">&#13;\n<p>Spark SQL does not support DELETE.</p>\n<p>If the number of ids to delete is small, you can do it using the Cassandra driver instead of through Spark:</p>\n<pre>import scala.collection.JavaConverters._\nimport scala.collection.JavaConversions._\nimport com.datastax.driver.core.{Cluster, Session, BatchStatement}\nimport com.datastax.driver.core.querybuilder.QueryBuilder\nval cluster = Cluster.builder().addContactPoint(host_ip).build()\nval session = cluster.connect(keyspace)\nval idsToDelete = ... // perform your query and collect the ids\nval queries = idsToDelete.map({ id =&gt; QueryBuilder.delete().from(keyspace, table).where(QueryBuilder.eq(\"id\", id)) })\nval batch = batchStatement().addAll(queries.asJava)\nsession.execute(batch)\ncluster.close\n</pre></div><div class=\"user-action-time\">&#13;\n        <a href=\"https://stackoverflow.com/posts/40288410/revisions\" title=\"show all edits to this post\">edited Oct 27 '16 at 16:34</a>&#13;</div><div class=\"user-details\">&#13;\n        &#13;\n        &#13;</div><div class=\"user-action-time\">&#13;\n        answered Oct 27 '16 at 15:18&#13;</div><div class=\"user-details\">&#13;\n        <a href=\"https://stackoverflow.com/users/2320087/didier\">Didier</a>&#13;\n        &#13;</div>"}}]}},"pageContext":{"alternative_id":12391}}